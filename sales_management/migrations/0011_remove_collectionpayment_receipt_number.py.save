# Generated by Django 4.0 on 2024-09-17 06:42

from django.db import migrations

def update_receipt_number(apps, schema_editor):
    CollectionPayment = apps.get_model('sales_management', 'CollectionPayment')
    # Ensure all receipt numbers are unique
    for payment in CollectionPayment.objects.all():
        if CollectionPayment.objects.filter(receipt_number=payment.receipt_number).count() > 1:
            payment.receipt_number = generate_unique_receipt_number()  # Your logic to create a unique number
            payment.save()
def update_receipt_number(apps, schema_editor):
    CollectionPayment = apps.get_model('sales_management', 'CollectionPayment')
    # Ensure all receipt numbers are unique
    for payment in CollectionPayment.objects.all():
        if CollectionPayment.objects.filter(receipt_number=payment.receipt_number).count() > 1:
            payment.receipt_number = generate_unique_receipt_number()  # Your logic to create a unique number
            payment.save()

class Migration(migrations.Migration):
    dependencies = [
        ('sales_management', '0013_alter_collectionpayment_receipt_number'),
    ]

    operations = [
        migrations.RunPython(update_receipt_number),
    ]


class Migration(migrations.Migration):

    dependencies = [
        ('sales_management', '0010_alter_collectionpayment_receipt_number'),
    ]

    operations = [
        migrations.RemoveField(
            model_name='collectionpayment',
            name='receipt_number',
        ),
    ]
